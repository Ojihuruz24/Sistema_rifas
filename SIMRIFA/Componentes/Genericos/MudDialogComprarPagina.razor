@using MudBlazor
@inject ISnackbar Snackbar;


<MudDialog>
	<DialogContent>
		<MudContainer Class="container-fluid" Style="max-height: 500px; overflow-y: scroll">


			@switch (Pagina)
			{
				case "/Empresa/Sorteos/Rifas01":

					<MudText Style="white-space: pre-wrap;">Rifas01 </MudText>
					break;
				case "/Empresa/Sorteos/Rifas02":
					<MudText Style="white-space: pre-wrap;">Rifas02 </MudText>
					break;

				case "/Empresa/Sorteos/Rifas03":

					<MudTabs Outlined="true" Position="Position.Top" Rounded="true" Border="true"
					 ApplyEffectsToContainer="true" Class="mt-8" PanelClass="pa-6">

						<MudTabPanel Text="Datos del Organizador">
							<MudExpansionPanel Text="Organizador* (Persona, Marca, Empresa...)" MaxHeight="300">

								<MudTextField T="string" Label="Nombre" Required="true" RequiredError="User name is required!" />

								<MudTextField T="string" Label="Pais" Required="true" RequiredError="User name is required!" />

								<MudTextField T="string" Label="Ubicación (Depart., Estado, Provincia...)" Required="true" RequiredError="User name is required!" />

								<MudTextField T="string" Label="Nombre del Responsable" Required="true" RequiredError="User name is required!" />

								<MudTextField T="string" Label="Correo" Required="true" RequiredError="User name is required!" />

								<MudTextField T="string" Label="Celular" Required="true" RequiredError="User name is required!" />

								<MudFileUpload T="IBrowserFile" FilesChanged="UploadFiles" Accept=".jpg, .png">
									<ButtonTemplate>
										<MudButton HtmlTag="label"
										   Variant="Variant.Filled"
										   Color="Color.Primary"
										   StartIcon="@Icons.Material.Filled.CloudUpload" for="@context.Id">
											Identificacion
										</MudButton>
									</ButtonTemplate>
								</MudFileUpload>

								@if (files != null)
								{
									<MudText Typo="@Typo.h6">@files.Count() File@(files.Count() == 1 ? "" : "s"):</MudText>
									<MudList>
										@foreach (var file in files)
										{
											<MudListItem Icon="@Icons.Material.Filled.AttachFile" @key="@file">
												@file.Name <code>@file.Size bytes</code>
											</MudListItem>
										}
									</MudList>
								}

							</MudExpansionPanel>

							<MudExpansionPanel Text="Redes sociales" MaxHeight="300">


								<MudTextField T="string" Label="Instagram" 
									Variant="Variant.Outlined" 
									Adornment="Adornment.Start" 
									AdornmentIcon="@Icons.Custom.Brands.Instagram" 
									AdornmentColor="Color.Primary" Required="true" RequiredError="User name is required!" />


									<MudTextField T="string" Label="Facebook" 
									Variant="Variant.Outlined" 
									Adornment="Adornment.Start" 
									AdornmentIcon="@Icons.Custom.Brands.Facebook" 
									AdornmentColor="Color.Primary" />

									<MudTextField T="string" Label="Tiktok" 
									Variant="Variant.Outlined" 
									Adornment="Adornment.Start" 
									AdornmentIcon="@Icons.Custom.Brands.TikTok" 
									AdornmentColor="Color.Primary" />

								<MudTextField T="string" Label="Sitio web"
									  Variant="Variant.Outlined"
									  Adornment="Adornment.Start"
									  AdornmentIcon="@Icons.Custom.Brands.Awesome"
									  AdornmentColor="Color.Primary" />

							</MudExpansionPanel>

							<MudExpansionPanel Text="Logo" MaxHeight="300">

								<MudFileUpload T="IBrowserFile" FilesChanged="UploadFiles">
									<ButtonTemplate>
										<MudFab HtmlTag="label"
										Color="Color.Secondary"
										StartIcon="@Icons.Material.Filled.Image"
										Label="Load picture" for="@context.Id" />
									</ButtonTemplate>
								</MudFileUpload>

								@if (files != null)
								{
									<MudText Typo="@Typo.h6">@files.Count() File@(files.Count() == 1 ? "" : "s"):</MudText>
									<MudList>
										@foreach (var file in files)
										{
											<MudListItem Icon="@Icons.Material.Filled.AttachFile" @key="@file">
												@file.Name <code>@file.Size bytes</code>
											</MudListItem>
										}
									</MudList>
								}

							</MudExpansionPanel>


							<MudExpansionPanel Text="Informacion de pago" MaxHeight="300">


							</MudExpansionPanel>


						</MudTabPanel>

						<MudTabPanel Text="MENU">
							<MudExpansionPanels>
								<MudExpansionPanel Text="Redes sociales" MaxHeight="300">
									<p>Aca van las redes sociales</p>
								</MudExpansionPanel>
							</MudExpansionPanels>


						</MudTabPanel>
						<MudTabPanel Text="Imagenes del sorteo">
							<div class="justify-content-center">
								<div class="col-md-12">
									<div id="myCarousel" class="carousel slide" data-ride="carousel" align="center">
										<div class="carousel-inner">
											<div class="carousel-item active"><img src="Img/1.png" class="rounded"></div>
											<div class="carousel-item"> <img src="Img/2.png" class="rounded"> </div>
											<div class="carousel-item"> <img src="Img/3.png" class="rounded"> </div>
											<div class="carousel-item"> <img src="Img/Rifa04_imagen.png" class="rounded"> </div>
										</div>
										<ol class="carousel-indicators list-inline">
											<li class="list-inline-item active">
												<a id="carousel-selector-0" class="selected" data-slide-to="0"
												   data-target="#myCarousel">
													<img src="Img/1.png" class="img-fluid rounded">
												</a>
											</li>
											<li class="list-inline-item">
												<a id="carousel-selector-1" data-slide-to="1"
												   data-target="#myCarousel">
													<img src="Img/2.png" class="img-fluid rounded">
												</a>
											</li>
											<li class="list-inline-item">
												<a id="carousel-selector-2" data-slide-to="2"
												   data-target="#myCarousel">
													<img src="Img/3.png" class="img-fluid rounded">
												</a>
											</li>
											<li class="list-inline-item">
												<a id="carousel-selector-3" data-slide-to="3"
												   data-target="#myCarousel">
													<img src="Img/Rifa04_imagen.png" class="img-fluid rounded">
												</a>
											</li>
										</ol>
									</div>
								</div>
							</div>
						</MudTabPanel>
						<MudTabPanel Text="Botones de compra">
							<button type="button" class="btn btn-primary btn-block rounded-lg" style="font-size:90%;">
								<MudIcon Class="buton" Icon="@Icons.Material.Filled.KeyboardDoubleArrowRight" /> COMPRAR EL CUPON POR 5 por valor de $ 20.0000
							</button>
							<button type="button" class="btn btn-primary btn-block rounded-lg" style="font-size:90%;">
								<MudIcon Class="buton" Icon="@Icons.Material.Filled.KeyboardDoubleArrowRight" />COMPRAR EL CUPON POR 5 por valor de $ 20.0000
							</button>
							<button type="button" class="btn btn-primary btn-block rounded-lg" style="font-size:90%;">
								<MudIcon Class="buton" Icon="@Icons.Material.Filled.KeyboardDoubleArrowRight" />COMPRAR EL CUPON POR 5 por valor de $ 20.0000
							</button>
						</MudTabPanel>

						<MudTabPanel Text="Cartas promocionales">
							<div class="card mb-4 shadow-sm">
								<div class="card-header">
									<h4 class="my-0 font-weight-normal">APROVECHA!</h4>
								</div>
								<div class="card-body">
									<h1 class="card-title price">$ 20.000</h1>
									<ul class="list-unstyled mt-3 mb-4">
										<li>¡Aprovecha nuestra oferta especial! </li>
										<li> Disfruta de increíbles descuentos</li>
										<li>¡Compra ahora y ahorra!</li>
										<!-- Añade más características aquí -->
									</ul>
									<button type="button" class="btn btn-lg btn-block btn-primary">COMPRAR</button>
								</div>
							</div>

							<div class="card mb-4 shadow-sm">
								<div class="card-header">
									<h4 class="my-0 font-weight-normal">APROVECHA!</h4>
								</div>
								<div class="card-body">
									<h1 class="card-title price">$ 20.000</h1>
									<ul class="list-unstyled mt-3 mb-4">
										<li>¡Aprovecha nuestra oferta especial! </li>
										<li> Disfruta de increíbles descuentos</li>
										<li>¡Compra ahora y ahorra!</li>
										<!-- Añade más características aquí -->
									</ul>
									<button type="button" class="btn btn-lg btn-block btn-primary">COMPRAR</button>
								</div>
							</div>

							<div class="card mb-4 shadow-sm">
								<div class="card-header">
									<h4 class="my-0 font-weight-normal">APROVECHA!</h4>
								</div>
								<div class="card-body">
									<h1 class="card-title price">$ 20.000</h1>
									<ul class="list-unstyled mt-3 mb-4">
										<li>¡Aprovecha nuestra oferta especial! </li>
										<li> Disfruta de increíbles descuentos</li>
										<li>¡Compra ahora y ahorra!</li>
										<!-- Añade más características aquí -->
									</ul>
									<button type="button" class="btn btn-lg btn-block btn-primary">COMPRAR</button>
								</div>
							</div>
						</MudTabPanel>

						<MudTabPanel Text="Informacion vital">
							<MudText>Content Three</MudText>
						</MudTabPanel>

						<MudTabPanel Text="Informacion vital">
							<MudText>Content Three</MudText>
						</MudTabPanel>
					</MudTabs>

					break;

				case "/Empresa/Sorteos/Rifas04":
					<MudText Style="white-space: pre-wrap;">Rifas04 </MudText>
					break;

				case "/Empresa/Sorteos/Rifas05":
					<MudText Style="white-space: pre-wrap;">Rifas05 </MudText>
					break;

				default:
					<MudText Style="white-space: pre-wrap;">No encontro la pagina </MudText>


					break;
			}

		</MudContainer>
	</DialogContent>
	<DialogActions>
		<MudButton OnClick="Cancel">Cancel</MudButton>
		<MudButton Color="Color.Primary" OnClick="Enviar">Enviar</MudButton>
	</DialogActions>
</MudDialog>


@code {

	[CascadingParameter]
	MudDialogInstance MudDialog { get; set; }

	[Parameter]
	public string TipoPagina { get; set; }

	[Parameter]
	public string Pagina { get; set; }


	protected override void OnInitialized()
	{
		imagenBase642 = "";
	}

	private void Cancel()
	{
		MudDialog.Cancel();
	}

	private void Enviar()
	{
		//In a real world scenario this bool would probably be a service to delete the item from api/database
		Snackbar.Add("Informacion enviada correctamente", Severity.Success);
		MudDialog.Close(DialogResult.Ok(true));
	}


	#region PAGINA 03

	private string imagenBase642;

	public byte[] LogoPagina { get; set; }

	IList<IBrowserFile> files = new List<IBrowserFile>();

	private string extensionname = "default";
	async Task OnChange2(InputFileChangeEventArgs e)
	{

		long maxAllowedSize = 26214400;
		try
		{
			foreach (var file in e.GetMultipleFiles())
			{

				var dsd = file.Size;

				try
				{

					CancellationTokenSource source = new CancellationTokenSource();
					CancellationToken token = source.Token;

					//loadedFiles.Add(file);
					extensionname = Path.GetExtension(file.Name);
					var imagefiletypes = new List<string>() { ".png", ".jpg" };
					if (imagefiletypes.Contains(extensionname))
					{
						files.Add(file);

						var resizedFile = await file.RequestImageFileAsync(file.ContentType, 300, 300);
						var buf = new byte[resizedFile.Size];
						using (var stream = resizedFile.OpenReadStream(cancellationToken: token))
						{
							await stream.ReadAsync(buf);
						}

						await Task.Delay(100);
						//imagenBase64 = null;
						imagenBase642 = "data:image/jpeg;base64, " + Convert.ToBase64String(buf);
						LogoPagina = buf;
						StateHasChanged();
					}
				}
				catch (Exception ex)
				{
					throw;
				}
			}
		}
		catch (Exception ex)
		{
			throw;
		}
	}

	private async Task Clear()
	{
		imagenBase642 = string.Empty;
		files.Clear();
		await Task.Delay(100);
	}


	private void UploadFiles(IBrowserFile file)
	{
		files.Add(file);
	}

	#endregion


}
